# AI 챗봇(GPTs) 연동 및 실시간 Q&A/예약 퍼널 구축

**Task ID:** T-004
**Status:** DONE
**Importance:** MUST
**Complexity:** 7/10
**Urgency:** 10/10
**Dependencies:** T-003

## Description

### 설명
OpenAI의 GPT-4o 모델을 활용하여 실시간으로 안과 관련 질문에 답변하는 AI 챗봇 기능을 구현합니다. 사용자의 질문은 Supabase Edge Function을 통해 처리되며, 상담 내역은 DB에 기록됩니다. 챗봇은 단순 정보 제공을 넘어 예약이나 상담으로 이어지는 CTA(Call To Action)를 포함합니다.

### 구현 상세
1.  **Edge Function 생성**: TRD의 `ai-consultation` 예시를 참고하여 Supabase Edge Function을 생성합니다. 이 함수는 프론트엔드로부터 사용자 질문을 받아 처리합니다.
2.  **OpenAI API 연동**: `openai` npm 패키지를 사용하여 Edge Function 내에서 GPT-4o API를 호출하는 로직을 구현합니다. `OPENAI_API_KEY`는 Supabase 환경 변수로 안전하게 관리합니다.
3.  **시스템 프롬프트 설계**: 챗봇의 역할(연수김안과의원 AI 어시스턴트), 응답 톤앤매너, 전문 용어 사용 지침 등을 정의하는 시스템 프롬프트를 작성합니다.
4.  **챗봇 UI 개발**: 사용자가 메시지를 입력하고 AI와 대화를 주고받을 수 있는 채팅 인터페이스를 React 컴포넌트로 구현합니다. `zustand`를 사용하여 채팅 상태(메시지 목록, 로딩 상태 등)를 관리합니다.
5.  **상담 기록 저장**: AI의 응답이 생성된 후, 사용자 질문과 AI 답변을 포함한 전체 대화 내용을 `consultations` 테이블에 JSONB 형태로 저장합니다.

### 테스트 전략
1.  **Q&A 정확도 테스트**: 다양한 시나리오의 질문(질병, 수술, 비용, 위치 등)을 입력하여 AI가 생성하는 답변의 정확성과 적절성을 검증합니다. (전문의 검수 필요)
2.  **응답 속도 측정**: 질문 입력 후 답변이 UI에 표시되기까지의 시간이 평균 3초 이내인지 확인합니다.
3.  **데이터 저장 확인**: 챗봇과의 대화가 종료된 후, 해당 내용이 `consultations` 테이블에 올바르게 저장되었는지 Supabase 대시보드에서 확인합니다.
4.  **에러 핸들링**: OpenAI API 호출 실패 등 예외 상황 발생 시, 사용자에게 적절한 에러 메시지를 표시하는지 테스트합니다.

---

**Created:** 2025-07-29T04:44:49.562Z
**Updated:** 2025-08-05T11:17:43.750Z
